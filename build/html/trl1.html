
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>OpenClinica &#8212; rpb-doc-internal 1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PACS Conquest" href="trl2.html" />
    <link rel="prev" title="Welcome to rpb-doc-internal’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="openclinica">
<h1>OpenClinica<a class="headerlink" href="#openclinica" title="Permalink to this headline">¶</a></h1>
<p>This article documents the installation of OpenClinica. OpenClinica is an open source software to create electronic CRF (Case Report Form). In RadPlanBio, it is one of the main components.</p>
<p>To begin with, login as root (<code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">su</span></code>). Perform <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">update</span></code>. Install some support packages such as yum-plugin-remove-with-leaves, links, bash-completion, net-tools, unzip, wget, vim, mlocate, epel-release, lsof, bzip2 and gcc.</p>
<p>Prior to installation, create an install folder to store the required .rpm and .war files.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /usr/local/oc
mkdir /usr/local/oc/install
</pre></div>
</div>
<div class="section" id="configurations-for-openclinica">
<h2>Configurations for OpenClinica<a class="headerlink" href="#configurations-for-openclinica" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="19%" />
<col width="26%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">OS</th>
<th class="head">Init</th>
<th class="head">Container, JDK</th>
<th class="head">Database</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CentOS 7</td>
<td><code class="docutils literal notranslate"><span class="pre">systemd</span></code></td>
<td>Tomcat 7, JDK 7</td>
<td>PostgreSQL 8.4</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="list-of-required-files">
<h2>List of required files<a class="headerlink" href="#list-of-required-files" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Tomcat 7</td>
<td>apache-tomcat-7.0.84.tar.gz</td>
</tr>
<tr class="row-even"><td>JDK 7</td>
<td>jdk-7u80-linux-x64.rpm</td>
</tr>
<tr class="row-odd"><td>PostgreSQL 8.4</td>
<td><p class="first">postgresql84-8.4.22-1PGDG.rhel6.x86_64.rpm</p>
<p>postgresql84-libs-8.4.22-1PGDG.rhel6.x86_64.rpm</p>
<p>postgresql84-server-8.4.22-1PGDG.rhel6.x86_64.rpm</p>
<p>postgresql84-contrib-8.4.22-1PGDG.rhel6.x86_64.rpm</p>
<p class="last">postgresql84-docs-8.4.22-1PGDG.rhel6.x86_64.rpm</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="jdk">
<h2>JDK<a class="headerlink" href="#jdk" title="Permalink to this headline">¶</a></h2>
<p>Remove OpenJDK if originally instaled on the system. Install Oracle jdk</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/local/oc/install
yum install jdk-7u80-linux-x64.rpm
ln -s /usr/java/default /usr/local/java
</pre></div>
</div>
</div>
<div class="section" id="container">
<h2>Container<a class="headerlink" href="#container" title="Permalink to this headline">¶</a></h2>
<p>Install container Tomcat 7</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/local/oc/install
mkdir /usr/tomcat
tar xvzf apache-tomcat-7.0.84.tar.gz
mv apache-tomcat-7.0.84 /usr/tomcat/.
ln -s /usr/tomcat/apache-tomcat-7.0.84 /usr/tomcat/latest
ln -s /usr/tomcat/latest /usr/tomcat/default
ln -s /usr/tomcat/default /usr/local/tomcat
</pre></div>
</div>
<p>Create user for tomcat service</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>groupadd tomcat1
useradd -g tomcat1 tomcat1
chown -Rf tomcat1.tomcat1 /usr/tomcat/apache-tomcat-7.0.84
chown -Rf tomcat1.tomcat1 /usr/tomcat/latest/
chown -Rf tomcat1.tomcat1 /usr/tomcat/default/
chown -Rf tomcat1.tomcat1 /usr/local/tomcat/
</pre></div>
</div>
<p>Create .service file for init</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vim /lib/systemd/system/tomcat.service
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>Tomcat version <span class="m">7</span>.0.85
<span class="nv">Documentation</span><span class="o">=</span>https://tomcat.apache.org/download-70.cgi
<span class="nv">After</span><span class="o">=</span>syslog.target
<span class="nv">After</span><span class="o">=</span>network.target

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>forking
<span class="nv">Restart</span><span class="o">=</span>always

<span class="nv">User</span><span class="o">=</span>tomcat1
<span class="nv">Group</span><span class="o">=</span>tomcat1

<span class="nv">Environment</span><span class="o">=</span><span class="nv">JAVA_HOME</span><span class="o">=</span>/usr/local/java
<span class="nv">Environment</span><span class="o">=</span><span class="nv">CATALINA_HOME</span><span class="o">=</span>/usr/local/tomcat
<span class="nv">Environment</span><span class="o">=</span><span class="s1">&#39;JAVA_OPTS=-Xms128m -Xmx512m -XX:PermSize=128m&#39;</span>

<span class="nv">ExecStart</span><span class="o">=</span>/usr/local/tomcat/bin/startup.sh
<span class="nv">ExecStop</span><span class="o">=</span>/usr/local/tomcat/bin/shutdown.sh
<span class="nv">SuccessExitStatus</span><span class="o">=</span><span class="m">143</span>

<span class="nv">TimeoutSec</span><span class="o">=</span><span class="m">0</span>

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></div>
</div>
<p>Enable and start the service</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl <span class="nb">enable</span> tomcat.service
systemctl start tomcat.service
systemctl status tomcat.service
</pre></div>
</div>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>To install PostgreSQL 8.4, the rpms are needed to be downloaded first</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/local/oc/install/
wget https://yum.postgresql.org/8.4/redhat/rhel-6-x86_64/postgresql84-libs-8.4.22-1PGDG.rhel6.x86_64.rpm
wget https://yum.postgresql.org/8.4/redhat/rhel-6-x86_64/postgresql84-8.4.22-1PGDG.rhel6.x86_64.rpm
wget https://yum.postgresql.org/8.4/redhat/rhel-6-x86_64/postgresql84-server-8.4.22-1PGDG.rhel6.x86_64.rpm
wget https://yum.postgresql.org/8.4/redhat/rhel-6-x86_64/postgresql84-contrib-8.4.22-1PGDG.rhel6.x86_64.rpm
wget https://yum.postgresql.org/8.4/redhat/rhel-6-x86_64/postgresql84-docs-8.4.22-1PGDG.rhel6.x86_64.rpm
</pre></div>
</div>
<p>Install the rpms</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yum install postgresql84-libs-8.4.22-1PGDG.rhel6.x86_64.rpm
yum install postgresql84-8.4.22-1PGDG.rhel6.x86_64.rpm
yum install postgresql84-server-8.4.22-1PGDG.rhel6.x86_64.rpm
yum install uuid
yum install postgresql84-contrib-8.4.22-1PGDG.rhel6.x86_64.rpm
yum install postgresql84-docs-8.4.22-1PGDG.rhel6.x86_64.rpm
</pre></div>
</div>
<p>Initialize database for postgres</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/etc/init.d/postgresql-8.4 initdb
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">postgresql.conf</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp /var/lib/pgsql/8.4/data/postgresql.conf /var/lib/pgsql/8.4/data/postgresql.conf.BAK
vim /var/lib/pgsql/8.4/data/postgresql.conf
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>listen <span class="nv">addresses</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="nv">port</span> <span class="o">=</span> <span class="m">5432</span>
</pre></div>
</div>
<p>Create symlink to <code class="docutils literal notranslate"><span class="pre">/opt/PostgreSQL</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /opt/PostgreSQL
ln -s /usr/pgsql-8.4 /opt/PostgreSQL/8.4
ln -s /var/lib/pgsql/8.4/data /opt/PostgreSQL/8.4/data
</pre></div>
</div>
<p>Prior to running the database, create an init .service file (non-optimized)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm /etc/init.d/postgresql-8.4
vim /lib/systemd/system/postgresql-8.4.service
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>Unit<span class="o">]</span>
<span class="nv">Description</span><span class="o">=</span>PostgreSQL <span class="m">8</span>.4 database server
<span class="nv">Documentation</span><span class="o">=</span>https://www.postgresql.org/docs/8.4/static/index.html
<span class="nv">After</span><span class="o">=</span>syslog.target
<span class="nv">After</span><span class="o">=</span>network.target

<span class="o">[</span>Service<span class="o">]</span>
<span class="nv">Type</span><span class="o">=</span>forking
<span class="nv">Restart</span><span class="o">=</span>always

<span class="nv">User</span><span class="o">=</span>postgres
<span class="nv">Group</span><span class="o">=</span>postgres

<span class="nv">OOMScoreAdjust</span><span class="o">=</span>-1000
<span class="nv">Environment</span><span class="o">=</span><span class="nv">PG_OOM_ADJUST_FILE</span><span class="o">=</span>/proc/self/oom_score_adj
<span class="nv">Environment</span><span class="o">=</span><span class="nv">PG_OOM_ADJUST_VALUE</span><span class="o">=</span><span class="m">0</span>

<span class="nv">Environment</span><span class="o">=</span><span class="nv">PGDATA</span><span class="o">=</span>/var/lib/pgsql/8.4/data/

<span class="nv">ExecStart</span><span class="o">=</span>/usr/pgsql-8.4/bin/pg_ctl start -D <span class="si">${</span><span class="nv">PGDATA</span><span class="si">}</span> -s -w -t <span class="m">300</span>
<span class="nv">ExecStop</span><span class="o">=</span>/usr/pgsql-8.4/bin/pg_ctl stop -D <span class="si">${</span><span class="nv">PGDATA</span><span class="si">}</span> -s -m fast
<span class="nv">ExecReload</span><span class="o">=</span>/usr/pgsql-8.4/bin/pg_ctl reload -D <span class="si">${</span><span class="nv">PGDATA</span><span class="si">}</span> -s

<span class="nv">TimeoutSec</span><span class="o">=</span><span class="m">0</span>

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></div>
</div>
<p>Enable and start the service</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl <span class="nb">enable</span> postgresql-8.4.service
systemctl start postgresql-8.4.service
systemctl status postgresql-8.4.service
</pre></div>
</div>
<p>Assign password to user postgres</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>su postgres
psql

ALTER USER postgres PASSWORD <span class="s1">&#39;xxxxxxxxx&#39;</span><span class="p">;</span>
<span class="se">\q</span>

<span class="nb">exit</span>
</pre></div>
</div>
<p>Edit authentication method to access database by editing <code class="docutils literal notranslate"><span class="pre">pg_hba.conf</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp /var/lib/pgsql/8.4/data/pg_hba.conf /var/lib/pgsql/8.4/data/pg_hba.conf.BAK
vim /var/lib/pgsql/8.4/data/pg_hba.conf
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span>
<span class="nb">local</span>   all             all                                     md5
host    all             all             <span class="m">127</span>.0.0.1/32            md5
</pre></div>
</div>
<p>Setup database for OpenClinica</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psql -U postgres -c <span class="s2">&quot;CREATE ROLE clinica LOGIN ENCRYPTED PASSWORD &#39;xxxxxxxxx&#39; SUPERUSER NOINHERIT NOCREATEDB NOCREATEROLE&quot;</span>
psql -U postgres -c <span class="s2">&quot;CREATE DATABASE openclinica WITH ENCODING=&#39;UTF8&#39; OWNER=clinica&quot;</span>
psql -U postgres

ALTER USER clinica WITH PASSWORD <span class="s1">&#39;xxxxxxxxx&#39;</span><span class="p">;</span>
<span class="se">\q</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h2>OpenClinica<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>We go to the install folder and unzip OpenClinica war file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl stop tomcat.service
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/local/oc/install
unzip OpenClinica.war -d OpenClinica
mv OpenClinica /usr/local/tomcat/webapps
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">datainfo.properties</span></code> file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vim /usr/local/tomcat/webapps/OpenClinica/WEB-INF/classes/datainfo.properties
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">dbType</span><span class="o">=</span>postgres
<span class="nv">dbUser</span><span class="o">=</span>clinica
<span class="nv">dbPass</span><span class="o">=</span>xxxxxxxxx
<span class="nv">db</span><span class="o">=</span>openclinica
<span class="nv">dbPort</span><span class="o">=</span><span class="m">5432</span>
<span class="nv">dbHost</span><span class="o">=</span>localhost

<span class="nv">filePath</span><span class="o">=</span><span class="si">${</span><span class="nv">catalina</span><span class="p">.home</span><span class="si">}</span>/<span class="si">${</span><span class="nv">WEBAPP</span><span class="p">.lower</span><span class="si">}</span>.data/

<span class="nv">sysURL</span><span class="o">=</span>http://localhost:8080/<span class="si">${</span><span class="nv">WEBAPP</span><span class="si">}</span>/MainMenu

log.dir<span class="o">=</span><span class="si">${</span><span class="nv">catalina</span><span class="p">.home</span><span class="si">}</span>/logs/openclinica
<span class="nv">logLocation</span><span class="o">=</span><span class="nb">local</span>

<span class="nv">logLevel</span><span class="o">=</span>info
syslog.host<span class="o">=</span>localhost
syslog.port<span class="o">=</span><span class="m">514</span>
</pre></div>
</div>
<p>Start tomcat and depends on the <code class="docutils literal notranslate"><span class="pre">filePath</span></code> parameter, a folder will be created that contains a new <code class="docutils literal notranslate"><span class="pre">datainfo.properties</span></code>. Subsequent changes on the settings must be performed on this file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl start tomcat.service
</pre></div>
</div>
<p>Test connection to OpenClinica</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>links <span class="m">127</span>.0.0.1:8080/OpenClinica/MainMenu
</pre></div>
</div>
</div>
<div class="section" id="openclinica-web-service">
<h2>OpenClinica Web Service<a class="headerlink" href="#openclinica-web-service" title="Permalink to this headline">¶</a></h2>
<p>The procedure is the same like installing OpenClinica</p>
<p>We go to the install folder and unzip OpenClinica war file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl stop tomcat.service
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/local/oc/install
unzip OpenClinica-ws.war -d OpenClinica-ws
mv OpenClinica-ws /usr/local/tomcat/webapps
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">datainfo.properties</span></code> file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vim /usr/local/tomcat/webapps/OpenClinica-ws/WEB-INF/classes/datainfo.properties
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">dbType</span><span class="o">=</span>postgres
<span class="nv">dbUser</span><span class="o">=</span>clinica
<span class="nv">dbPass</span><span class="o">=</span>xxxxxxxxx
<span class="nv">db</span><span class="o">=</span>openclinica
<span class="nv">dbPort</span><span class="o">=</span><span class="m">5432</span>
<span class="nv">dbHost</span><span class="o">=</span>localhost

<span class="nv">filePath</span><span class="o">=</span><span class="si">${</span><span class="nv">catalina</span><span class="p">.home</span><span class="si">}</span>/<span class="si">${</span><span class="nv">WEBAPP</span><span class="p">.lower</span><span class="si">}</span>.data/

<span class="nv">sysURL</span><span class="o">=</span>http://localhost:8080/<span class="si">${</span><span class="nv">WEBAPP</span><span class="si">}</span>/MainMenu

log.dir<span class="o">=</span><span class="si">${</span><span class="nv">catalina</span><span class="p">.home</span><span class="si">}</span>/logs/openclinica
<span class="nv">logLocation</span><span class="o">=</span><span class="nb">local</span>

<span class="nv">logLevel</span><span class="o">=</span>info
syslog.host<span class="o">=</span>localhost
syslog.port<span class="o">=</span><span class="m">514</span>
</pre></div>
</div>
<p>Start Tomcat and another folder will be created too with a new <code class="docutils literal notranslate"><span class="pre">datainfo.properties</span></code> file.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl start tomcat.service
</pre></div>
</div>
<p>Test connection to OpenClinica Web Service</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>links <span class="m">127</span>.0.0.1:8080/OpenClinica-ws/MainMenu
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">OpenClinica</a><ul>
<li><a class="reference internal" href="#configurations-for-openclinica">Configurations for OpenClinica</a></li>
<li><a class="reference internal" href="#list-of-required-files">List of required files</a></li>
<li><a class="reference internal" href="#jdk">JDK</a></li>
<li><a class="reference internal" href="#container">Container</a></li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#id1">OpenClinica</a></li>
<li><a class="reference internal" href="#openclinica-web-service">OpenClinica Web Service</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to rpb-doc-internal’s documentation!</a></li>
      <li>Next: <a href="trl2.html" title="next chapter">PACS Conquest</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/trl1.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Wahyu Wijaya Hadiwikarta.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/trl1.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>